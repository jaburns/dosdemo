#!/usr/bin/env bash

install_nasm() {
    rm -rf nasm
    wget http://www.nasm.us/pub/nasm/releasebuilds/2.14rc0/dos/nasm-2.14rc0-dos.zip
    unzip nasm-2.14rc0-dos.zip
    rm nasm-2.14rc0-dos.zip
    mv nasm-2.14rc0 nasm
}

float_to_byte() {
    local ret="$(echo "obase=16; (255.0*$1+0.5)/1" | bc)"
    [[ "${#ret}" -lt 2 ]] && printf 0
    echo "$ret"
}

create_sine_table() {
    for i in {0..255}; do
        local float_val="$(echo "s($i / 255 * 3.14159265358979)" | bc -l)"
        float_to_byte "$float_val"
    done
}

install_nasm
create_sine_table | xxd -r -p > sine.dat
